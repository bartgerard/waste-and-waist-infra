name: ww-infra

deploy:
  - helm repo add elastic https://helm.elastic.co
  - helm upgrade --install elasticsearch elastic/elasticsearch -f chart/elasticsearch/values.yaml
  # https://artifacthub.io/packages/helm/bitnami/postgresql
  #- helm repo add bitnami https://charts.bitnami.com/bitnami
  #- helm upgrade --install postgresql bitnami/postgresql
  - kubectl apply -k k8s/app

dev:
  okteto-port-forwarding:
    image: busybox
    workdir: /usr/src/app
    command: sh
    forward:
      - 5432:postgresql:5432
      - 9200:elasticsearch-master:9200
    resources:
      limits:
        cpu: "125m"
        memory: "64Mi"
    persistentVolume:
      enabled: false